%Title: \SYSTEMLEO{}: A machine learning approach to minimizing energy under performance constraints

\section{Introduction}

% Two trends: energy and load variations
This work addresses two trends in modern computing systems.  First,
energy is increasingly important; reducing energy consumption reduces
operating costs in datacenters and increases battery life in mobile
devices.  Second, computer systems are often underutilized, meaning
there are significant portions of time where application performance
demands do not require the full system capacity
\cite{google2007,MeisnerISCA2011}.

% Problem: How to minimize energy while meeting load demands
These two trends raise the problem of allocating available resources
to meet the current performance demand while minimizing energy
consumption. This problem is a \emph{constrained optimization}
problem. The current utilization level represents a performance
constraint (\ie an amount of work that must be completed in a given
time); system energy consumption represents the objective function to
be minimized.

% Prior approaches: heuristics (race-to-idle) and convex optimization
This problem is challenging because it requires a great deal of
knowledge to solve.  More than knowledge of the single fastest, or
most energy efficient system configuration solving this problem
requires knowledge of the power and performance available in all
configurations and the extraction of those configurations that
represent Pareto-optimal tradeoffs.  Acquiring this knowledge is
additionally complicated by the fact that these power/performance
tradeoffs are often application -- or even input -- dependent.  Thus,
there is a need for techniques that accurately estimate these
application-dependent parameters during run-time.

Machine learning techniques represent a promising approach to
addressing this estimation problem.  \emph{Offline learning}
approaches collect profiling data for known applications and use that
to predict optimal behavior for unseen applications (examples include
\cite{Yi2003,Koala,LeeBrooks2006,CPR,ChenJohn2011}).  \emph{Online
  learning} approaches use information collected while an application
is running to quickly estimate the optimal configuration (examples
include
\cite{Li2006,Flicker,ParallelismDial,Ponamarev,petabricksDynamic,LeeBrooks,TAAS}).
Offline methods require minimal runtime overhead, but suffer because
they estimate only trends and cannot adapt to particulars of the
current application.  Online methods customize to the current
application, but cannot leverage experience from other applications.
In a sense, offline approaches are dependent on a rich training set
that represents all possible behavior, while the online approaches
generate a statistically weak -- \ie inaccurate -- estimator due to
small sample size.

In this work, we present \SYSTEMLEO{} (Learning for Energy
Optimization), a learning framework that combines the best of both
worlds, \ie the statistical properties both offline and online
estimation.  We assume that there is some set of applications for
which the power and performance tradeoffs are gathered offline.
\SYSTEMLEO{} uses a graphical model to integrate a small number of
observations of the current application with knowledge of the
previously observed applications to produce accurate estimations of
power and performance tradeoffs for the current application in all
configurations.  \SYSTEMLEO{}'s strength is that it quickly matches the
behavior of the current application to a subset of the previously
observed applications.  For example, if \SYSTEMLEO{} has previously seen
an application that only scales to 8 cores, it can use that
information to quickly determine if the current application will be
limited in its scaling.


% Limitations and uses \TODO{Need to have a paragraph here on
%   limitations - but keep it positive.}
\SYSTEMLEO{} is a fairly general approach in that it supports many types
of applications with different resource needs.  It is not, however,
appropriate for all computer systems, especially ones, which run many
small, unique jobs.  Instead, it focuses on supporting systems that 1)
execute longer running jobs (in the 10s of seconds) or many repeated
instances of short jobs, 2) run at a wide range of utilizations, and
3) might have phases where optimal tradeoffs may change online.  For
systems that meet these criteria, \SYSTEMLEO{} provides a powerful
ability to reduce the energy consumption.  For systems that service
short ( $< 1$ second), largely unique jobs, \SYSTEMLEO{} will work, but
other approaches are probably better matched to those specific needs.
%\TODO{its probably alright for full utilization systems too because it can tell which configuration provides maximum utilization. Also, race-to-idle is not mentioned in intro?}

% Our results
We have implemented \SYSTEMLEO{} on a Linux x86 server and tested its
ability to minimize energy for 25 different applications from a
variety of different benchmark suites.  We first compare \SYSTEMLEO{}'s
performance and power prediction accuracy to (1) the true value, (2)
an offline approach, and (3) an online approach (See
\Secref{sec:poc}).  On average, \SYSTEMLEO{} is within 97\% of the true
value while the offline and online approaches only achieve 79\% and
86\% accuracy, respectively.  We then use \SYSTEMLEO{} to minimize energy
for various performance requirements (or system utilizations) (See
\Secref{sec:experiment:LP}).  Overall we find that our approach is
within 6\% of the true optimal energy, while the offline approach
exceeds optimal energy consumption by 29\% and online approach by
24\%.  Finally, we show that \SYSTEMLEO{} provides near optimal energy
savings when adapting to phases within an application.

% Contributions of this work
This work makes the following contributions:
\begin{itemize}
\item To the best of our knowledge, this is the first application of
  probabilistic graphical models for solving crucial system
  optimization problems such as energy minimization.
\item It presents a graphical model capable of accurately
  estimating the application-specific performance and power of
  computer system configurations without prior knowledge of the
  application. (See \Secref{sec:HBN}).
\item It makes the source code for this learning system available in
  both Matlab and C++\footnote{leo.cs.uchicago.edu}.
\item It evaluates \SYSTEMLEO{} on a real system. (See
  \Secref{sec:experiment}).
\item It compares the accuracy of \SYSTEMLEO{}'s estimations to both the
  truth and to offline and online learning approaches (See
  \Secref{sec:experiment:PP}).
\item It integrates \SYSTEMLEO{} into a runtime for energy optimization
  and finds this learning framework achieves near-optimal energy
  savings.  Furthermore, \SYSTEMLEO{} significantly reduces energy
  compared to both offline and online approaches as well as the
  popular race-to-idle heuristic.  (See
  \Secref{sec:experiment:LP}).
\end{itemize}

The rest of the work is organized as follows. \Secref{sec:example}
provides a motivational example to build intuition.
\Secref{sec:notation} presents notation.
\Secref{sec:problemFormulation} formalizes the energy minimization
problem as a linear program and discusses the application-specific
parameters of this problem.  \Secref{sec:HBN} elaborates our probabilistic graphical model and describes \SYSTEMLEO{} in full detail.
\Secref{sec:experiment} presents empirical studies on \SYSTEMLEO{}.
Related work is discussed in \Secref{sec:related} and the work
concludes in \secref{conclusion}.
